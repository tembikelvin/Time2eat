class Time2EatApp { constructor() { this.init(); } init() { this.initializeFeatherIcons(); this.initializeModals(); this.initializeToasts(); this.initializeDropdowns(); this.initializeSearch(); this.initializeCart(); this.initializeLazyLoading(); this.initializeAnimations(); this.initializeAccessibility(); } initializeFeatherIcons() { if (typeof feather !== 'undefined') { feather.replace(); const observer = new MutationObserver(() => { feather.replace(); }); observer.observe(document.body, { childList: true, subtree: true }); } } initializeModals() { window.openModal = (modalId) => { const modal = document.getElementById(modalId); if (modal) { modal.classList.remove('tw-hidden'); modal.classList.add('tw-fade-in'); document.body.style.overflow = 'hidden'; const firstFocusable = modal.querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'); if (firstFocusable) { firstFocusable.focus(); } this.trapFocus(modal); } }; window.closeModal = (modalId) => { const modal = document.getElementById(modalId); if (modal) { modal.classList.add('tw-fade-out'); setTimeout(() => { modal.classList.add('tw-hidden'); modal.classList.remove('tw-fade-in', 'tw-fade-out'); document.body.style.overflow = ''; }, 300); } }; document.addEventListener('keydown', (e) => { if (e.key === 'Escape') { const openModal = document.querySelector('.tw-modal-overlay:not(.tw-hidden)'); if (openModal) { const modalId = openModal.id; if (modalId) { closeModal(modalId); } } } }); } initializeToasts() { window.showToast = (message, type = 'info', duration = 5000) => { const toast = document.createElement('div'); const toastId = 'toast-' + Date.now(); const icons = { success: 'check-circle', error: 'alert-circle', warning: 'alert-triangle', info: 'info' }; toast.id = toastId; toast.className = `tw-toast tw-toast-${type} tw-translate-x-full`; toast.innerHTML = ` <div class="tw-flex tw-items-start tw-space-x-3"> <i data-feather="${icons[type] || icons.info}" class="tw-w-5 tw-h-5 tw-flex-shrink-0 tw-mt-0.5" aria-hidden="true"></i> <div class="tw-flex-1"> <p class="tw-font-medium">${message}</p> </div> <button class="tw-text-current tw-opacity-70 hover:tw-opacity-100 tw-p-1 tw-rounded tw-min-h-[32px] tw-min-w-[32px] tw-flex tw-items-center tw-justify-center" onclick="closeToast('${toastId}')" aria-label="Close notification" > <i data-feather="x" class="tw-w-4 tw-h-4" aria-hidden="true"></i> </button> </div> `; document.body.appendChild(toast); feather.replace(); setTimeout(() => { toast.classList.remove('tw-translate-x-full'); }, 100); setTimeout(() => { this.closeToast(toastId); }, duration); }; window.closeToast = (toastId) => { this.closeToast(toastId); }; } closeToast(toastId) { const toast = document.getElementById(toastId); if (toast) { toast.classList.add('tw-translate-x-full'); setTimeout(() => { if (toast.parentElement) { toast.parentElement.removeChild(toast); } }, 300); } } initializeDropdowns() { document.addEventListener('click', (e) => { const dropdown = e.target.closest('[data-dropdown]'); if (dropdown) { e.preventDefault(); const menu = dropdown.querySelector('.tw-dropdown'); const isOpen = !menu.classList.contains('tw-hidden'); document.querySelectorAll('.tw-dropdown').forEach(d => { d.classList.add('tw-hidden'); }); if (!isOpen) { menu.classList.remove('tw-hidden'); menu.classList.add('tw-fade-in'); } dropdown.setAttribute('aria-expanded', !isOpen); } else { document.querySelectorAll('.tw-dropdown').forEach(d => { d.classList.add('tw-hidden'); }); document.querySelectorAll('[data-dropdown]').forEach(d => { d.setAttribute('aria-expanded', 'false'); }); } }); } initializeSearch() { const searchInputs = document.querySelectorAll('[data-search]'); searchInputs.forEach(input => { let searchTimeout; input.addEventListener('input', (e) => { clearTimeout(searchTimeout); const query = e.target.value.trim(); if (query.length >= 2) { searchTimeout = setTimeout(() => { this.performSearch(query, input); }, 300); } else { this.hideSearchResults(input); } }); document.addEventListener('click', (e) => { if (!input.contains(e.target)) { this.hideSearchResults(input); } }); }); } performSearch(query, input) { const resultsContainer = input.parentElement.querySelector('.tw-search-results'); if (!resultsContainer) return; resultsContainer.innerHTML = ` <div class="tw-px-4 tw-py-3 tw-text-center"> <div class="tw-flex tw-items-center tw-justify-center tw-space-x-2"> <i data-feather="loader" class="tw-w-4 tw-h-4 tw-animate-spin" aria-hidden="true"></i> <span class="tw-text-sm tw-text-gray-600">Searching...</span> </div> </div> `; resultsContainer.classList.remove('tw-hidden'); feather.replace(); setTimeout(() => { const mockResults = [ { name: 'Chicken Shawarma', restaurant: 'Bamenda Grill', price: '2500 FCFA' }, { name: 'Jollof Rice', restaurant: 'Mama\'s Kitchen', price: '2000 FCFA' }, { name: 'Grilled Fish', restaurant: 'Ocean View', price: '3500 FCFA' } ]; if (mockResults.length > 0) { resultsContainer.innerHTML = mockResults.map(result => ` <div class="tw-search-result-item" onclick="selectSearchResult('${result.name}')"> <div class="tw-flex tw-justify-between tw-items-center"> <div> <p class="tw-font-medium tw-text-gray-900">${result.name}</p> <p class="tw-text-sm tw-text-gray-600">${result.restaurant}</p> </div> <span class="tw-text-primary-600 tw-font-semibold">${result.price}</span> </div> </div> `).join(''); } else { resultsContainer.innerHTML = ` <div class="tw-px-4 tw-py-3 tw-text-center tw-text-gray-500"> <i data-feather="search" class="tw-w-8 tw-h-8 tw-mx-auto tw-mb-2 tw-text-gray-400" aria-hidden="true"></i> <p>No results found for "${query}"</p> </div> `; } feather.replace(); }, 500); } hideSearchResults(input) { const resultsContainer = input.parentElement.querySelector('.tw-search-results'); if (resultsContainer) { resultsContainer.classList.add('tw-hidden'); } } initializeCart() { let cartItems = JSON.parse(localStorage.getItem('cart') || '[]'); window.addToCart = (itemId, name, price, image) => { const existingItem = cartItems.find(item => item.id === itemId); if (existingItem) { existingItem.quantity += 1; } else { cartItems.push({ id: itemId, name: name, price: price, image: image, quantity: 1 }); } localStorage.setItem('cart', JSON.stringify(cartItems)); this.updateCartUI(); showToast(`${name} added to cart!`, 'success'); }; window.removeFromCart = (itemId) => { cartItems = cartItems.filter(item => item.id !== itemId); localStorage.setItem('cart', JSON.stringify(cartItems)); this.updateCartUI(); showToast('Item removed from cart', 'info'); }; window.updateCartQuantity = (itemId, quantity) => { const item = cartItems.find(item => item.id === itemId); if (item) { item.quantity = Math.max(0, quantity); if (item.quantity === 0) { cartItems = cartItems.filter(item => item.id !== itemId); } localStorage.setItem('cart', JSON.stringify(cartItems)); this.updateCartUI(); } }; window.clearCart = () => { if (confirm('Are you sure you want to clear your cart?')) { cartItems = []; localStorage.setItem('cart', JSON.stringify(cartItems)); this.updateCartUI(); showToast('Cart cleared', 'info'); } }; this.updateCartUI(); } updateCartUI() { const cartItems = JSON.parse(localStorage.getItem('cart') || '[]'); const totalItems = cartItems.reduce((sum, item) => sum + item.quantity, 0); document.querySelectorAll('[data-cart-count]').forEach(badge => { badge.textContent = totalItems > 99 ? '99+' : totalItems.toString(); badge.style.display = totalItems > 0 ? 'flex' : 'none'; }); document.querySelectorAll('[data-cart-icon]').forEach(icon => { if (totalItems > 0) { icon.classList.add('tw-text-primary-600'); } else { icon.classList.remove('tw-text-primary-600'); } }); } initializeLazyLoading() { if ('IntersectionObserver' in window) { const imageObserver = new IntersectionObserver((entries) => { entries.forEach(entry => { if (entry.isIntersecting) { const img = entry.target; if (img.dataset.src) { img.src = img.dataset.src; img.classList.remove('tw-opacity-0'); img.classList.add('tw-fade-in'); imageObserver.unobserve(img); } } }); }); document.querySelectorAll('img[data-src]').forEach(img => { img.classList.add('tw-opacity-0', 'tw-transition-opacity'); imageObserver.observe(img); }); } } initializeAnimations() { if ('IntersectionObserver' in window) { const animationObserver = new IntersectionObserver((entries) => { entries.forEach(entry => { if (entry.isIntersecting) { const element = entry.target; const animation = element.dataset.animate; const delay = element.dataset.delay || '0'; setTimeout(() => { element.classList.add(animation); }, parseInt(delay)); animationObserver.unobserve(element); } }); }); document.querySelectorAll('[data-animate]').forEach(el => { animationObserver.observe(el); }); } } initializeAccessibility() { const skipLink = document.querySelector('a[href="#main-content"]'); if (skipLink) { skipLink.addEventListener('click', (e) => { e.preventDefault(); const mainContent = document.getElementById('main-content'); if (mainContent) { mainContent.focus(); mainContent.scrollIntoView(); } }); } document.addEventListener('keydown', (e) => { if ((e.key === 'Enter' || e.key === ' ') && e.target.hasAttribute('data-button')) { e.preventDefault(); e.target.click(); } }); } trapFocus(element) { const focusableElements = element.querySelectorAll( 'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])' ); const firstFocusable = focusableElements[0]; const lastFocusable = focusableElements[focusableElements.length - 1]; element.addEventListener('keydown', (e) => { if (e.key === 'Tab') { if (e.shiftKey) { if (document.activeElement === firstFocusable) { e.preventDefault(); lastFocusable.focus(); } } else { if (document.activeElement === lastFocusable) { e.preventDefault(); firstFocusable.focus(); } } } }); } } document.addEventListener('DOMContentLoaded', () => { window.time2eatApp = new Time2EatApp(); }); window.selectSearchResult = (itemName) => { console.log('Selected:', itemName); }; window.toggleFavorite = (itemId) => { const favorites = JSON.parse(localStorage.getItem('favorites') || '[]'); const index = favorites.indexOf(itemId); if (index > -1) { favorites.splice(index, 1); showToast('Removed from favorites', 'info'); } else { favorites.push(itemId); showToast('Added to favorites', 'success'); } localStorage.setItem('favorites', JSON.stringify(favorites)); document.querySelectorAll(`[data-favorite="${itemId}"]`).forEach(btn => { const icon = btn.querySelector('i'); if (favorites.includes(itemId)) { icon.setAttribute('data-feather', 'heart'); btn.classList.add('tw-text-red-500'); } else { icon.setAttribute('data-feather', 'heart'); btn.classList.remove('tw-text-red-500'); } }); feather.replace(); };